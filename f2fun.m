function [f,g,H]=f2fun(x)
f=100*(x(2)-x(1)^2)^2+(1-x(1))^2+90*(x(4)-x(3)^2)^2+(1-x(3))^2+10.1*((1-x(2))^2+(1-x(4))^2)+19.8*(x(2)-1)*(x(4)-1);
if nargout > 1
    g(1)=400*x(1)*(x(1)^2-x(2))+2*(x(1)-1);
    g(2)=200*(x(2)-x(1)^2)+20.2*(x(2)-1)+19.8*(x(4)-1);
    g(3)=360*x(3)*(x(3)^2-x(4))+2*(x(3)-1);
    g(4)=180*(x(4)-x(3)^2)+20.2*(x(4)-1)+19.8*(x(2)-1);
end
if nargout > 2
    H=[
        1200*x(1)^2-400*x(2)+2,-400*x(1),0,0;
        -400*x(1),220.2,0,19.8;
        0,0,1440*x(3)^2-360*x(4)+2,-360;
        0,19.8,-360*x(3),200.2
    ];
end

